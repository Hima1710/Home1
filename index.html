<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>نظام حسابات خالي عادل</title>
    <link href="https://fonts.googleapis.com/css2?family=Cairo:wght@300;400;600;700&display=swap" rel="stylesheet" />
    <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Material+Icons&display=swap" />
    <link rel="stylesheet" href="style.css" />
</head>
<body>
    <!-- Login Overlay -->
    <div id="loginOverlay" class="login-overlay">
        <div class="login-container">
            <div class="login-header">
                <i class="material-icons">lock</i>
                <h2>تسجيل الدخول</h2>
            </div>
            <form id="loginForm" class="login-form">
                <div class="form-group">
                    <label for="phone">رقم الهاتف</label>
                    <input type="text" id="phone" required />
                </div>
                <div class="form-group">
                    <label for="password">كلمة المرور</label>
                    <input type="password" id="password" required />
                </div>
                <button type="submit" class="btn btn-primary login-btn">تسجيل الدخول</button>
                <div id="loginError" class="login-error"></div>
                <div id="retryButton" class="retry-button" style="display: none;">
                    <button type="button" class="btn btn-warning" onclick="retryLogin()">
                        <i class="material-icons">refresh</i> إعادة المحاولة
                    </button>
                </div>
            </form>
        </div>
    </div>

    <!-- Loading Spinner -->
    <div id="loadingSpinner" class="loading-spinner">
        <div class="spinner"></div>
        <div id="loadingText" class="loading-text"></div>
    </div>

    <!-- Main Content -->
    <div id="mainContent" style="display:none;">
        <header class="header">
            <div class="container">
                <div class="logo">
                    <i class="material-icons">account_balance</i>
                    <h1>النظام المالي</h1>
                </div>
                <nav class="nav">
                    <button id="navToggle" class="nav-toggle">
                        <span></span>
                        <span></span>
                        <span></span>
                    </button>
                    <ul id="navMenu" class="nav-menu">
                        <li><a href="#dashboard" class="nav-link active">لوحة التحكم</a></li>
                        <li><a href="#income" class="nav-link">الدخل</a></li>
                        <li><a href="#expenses" class="nav-link">المصروفات</a></li>
                        <li><a href="#workers" class="nav-link">العمال</a></li>
                        <li><a href="#returns" class="nav-link">الاسترجاع</a></li>
                        <li>
                            <button onclick="logout()" class="btn btn-danger logout-btn">تسجيل الخروج</button>
                        </li>
                    </ul>
                </nav>
            </div>
        </header>

        <main class="main container">
            <!-- Dashboard Section -->
            <section id="dashboard" class="section active">
                <div class="section-header">
                    <h2>لوحة التحكم</h2>
                    <p>ملخص سريع لكل الحسابات</p>
                    <div class="dashboard-buttons">
                        <button class="btn btn-success" onclick="loadAllData()">
                            <i class="material-icons">sync</i> تحديث الكل
                        </button>
                    </div>
                </div>
                <div class="stats-grid">
                    <div class="stat-card">
                        <div class="stat-icon">
                            <i class="material-icons">arrow_upward</i>
                        </div>
                        <div class="stat-content">
                            <h3>الدخل بالجنيه</h3>
                            <div class="stat-value" id="summaryIncomeEGP">0</div>
                        </div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-icon">
                            <i class="material-icons">attach_money</i>
                        </div>
                        <div class="stat-content">
                            <h3>الدخل بالدولار</h3>
                            <div class="stat-value" id="summaryIncomeUSD">0</div>
                        </div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-icon">
                            <i class="material-icons">arrow_downward</i>
                        </div>
                        <div class="stat-content">
                            <h3>المصروفات بالجنيه</h3>
                            <div class="stat-value" id="summaryExpensesEGP">0</div>
                        </div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-icon">
                            <i class="material-icons">money_off</i>
                        </div>
                        <div class="stat-content">
                            <h3>المصروفات بالدولار</h3>
                            <div class="stat-value" id="summaryExpensesUSD">0</div>
                        </div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-icon">
                            <i class="material-icons">show_chart</i>
                        </div>
                        <div class="stat-content">
                            <h3>صافي بالجنيه</h3>
                            <div class="stat-value" id="summaryNetEGP">0</div>
                        </div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-icon">
                            <i class="material-icons">trending_up</i>
                        </div>
                        <div class="stat-content">
                            <h3>صافي بالدولار</h3>
                            <div class="stat-value" id="summaryNetUSD">0</div>
                        </div>
                    </div>
                </div>
            </section>

            <!-- Income Section -->
            <section id="income" class="section">
                <div class="section-header">
                    <h2>الدخل</h2>
                </div>
                <div class="add-button-container">
                    <button class="btn btn-primary" onclick="openAddModal('income')">
                        <i class="material-icons">add</i> إضافة دخل جديد
                    </button>
                </div>
                <div class="data-table-container">
                    <table class="data-table">
                        <thead>
                            <tr>
                                <th>التاريخ</th>
                                <th>المصدر (منين جالي)</th>
                                <th>المبلغ</th>
                                <th>العملة</th>
                                <th>طريقة الدفع</th>
                                <th>ملاحظات</th>
                                <th>المستخدم</th>
                                <th>حذف</th>
                            </tr>
                        </thead>
                        <tbody id="incomeTableBody"></tbody>
                    </table>
                </div>
            </section>

            <!-- Expenses Section -->
            <section id="expenses" class="section">
                <div class="section-header">
                    <h2>المصروفات</h2>
                </div>
                <div class="add-button-container">
                    <button class="btn btn-danger" onclick="openAddModal('expenses')">
                        <i class="material-icons">add</i> إضافة مصروف جديد
                    </button>
                </div>
                <div class="data-table-container">
                    <table class="data-table">
                        <thead>
                            <tr>
                                <th>التاريخ</th>
                                <th>المصدر (اتصرف فين)</th>
                                <th>المبلغ</th>
                                <th>العملة</th>
                                <th>طريقة الدفع</th>
                                <th>ملاحظات</th>
                                <th>المستخدم</th>
                                <th>حذف</th>
                            </tr>
                        </thead>
                        <tbody id="expensesTableBody"></tbody>
                    </table>
                </div>
            </section>

            <!-- Workers Section -->
            <section id="workers" class="section">
                <div class="section-header">
                    <h2>العمال</h2>
                </div>
                <div class="add-button-container">
                    <button class="btn btn-success" onclick="openAddModal('workers')">
                        <i class="material-icons">add</i> إضافة عامل جديد
                    </button>
                </div>
                <div class="data-table-container">
                    <table class="data-table">
                        <thead>
                            <tr>
                                <th>التاريخ</th>
                                <th>اسم العامل</th>
                                <th>المبلغ</th>
                                <th>العملة</th>
                                <th>طريقة الدفع</th>
                                <th>ملاحظات</th>
                                <th>المستخدم</th>
                                <th>حذف</th>
                            </tr>
                        </thead>
                        <tbody id="workersTableBody"></tbody>
                    </table>
                </div>
            </section>

            <!-- Returns Section -->
            <section id="returns" class="section">
                <div class="section-header">
                    <h2>الاسترجاع</h2>
                </div>
                <div class="add-button-container">
                    <button class="btn btn-warning" onclick="openAddModal('returns')">
                        <i class="material-icons">add</i> إضافة استرجاع جديد
                    </button>
                </div>
                <div class="data-table-container">
                    <table class="data-table">
                        <thead>
                            <tr>
                                <th>التاريخ</th>
                                <th>المصدر (مين رجع)</th>
                                <th>المبلغ</th>
                                <th>العملة</th>
                                <th>طريقة الدفع</th>
                                <th>ملاحظات</th>
                                <th>المستخدم</th>
                                <th>حذف</th>
                            </tr>
                        </thead>
                        <tbody id="returnsTableBody"></tbody>
                    </table>
                </div>
            </section>
        </main>
    </div>

    <!-- Add Modal -->
    <div id="addModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3 id="modalTitle">إضافة بيانات</h3>
                <button class="modal-close" onclick="closeModal()">×</button>
            </div>
            <div class="modal-body">
                <form id="addForm">
                    <div class="form-group">
                        <label>التاريخ</label>
                        <input id="date" type="date" required />
                    </div>
                    <div class="form-group">
                        <label id="sourceLabel">المصدر</label>
                        <input id="source" type="text" required />
                    </div>
                    <div class="form-group">
                        <label>المبلغ</label>
                        <input id="amount" type="number" required />
                    </div>
                    <div class="form-group">
                        <label>العملة</label>
                        <select id="currency">
                            <option value="EGP">جنيه</option>
                            <option value="USD">دولار</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label>طريقة الدفع</label>
                        <input id="paymentMethod" type="text" />
                    </div>
                    <div class="form-group">
                        <label>ملاحظات</label>
                        <textarea id="notes"></textarea>
                    </div>
                    <div class="form-group">
                        <label>المستخدم</label>
                        <input id="user" type="text" />
                    </div>
                    <div class="form-actions">
                        <button type="submit" class="btn btn-primary">إضافة</button>
                        <button type="button" class="btn btn-secondary" onclick="closeModal()">إلغاء</button>
                    </div>
                </form>
            </div>
        </div>
    </div>

    <script src="script.js"></script>
</body>
</html>